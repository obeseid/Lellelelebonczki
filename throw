-- Auto Lasso Throw Script
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local player = Players.LocalPlayer
local mouse = player:GetMouse()

-- Configuration
local CHECK_INTERVAL = 0.2
local AUTO_THROW_RANGE = 25
local THROW_COOLDOWN = 1.5

-- State
local lastThrowTime = 0
local running = true

-- Function to check if model is valid target
local function isValidTarget(model)
	if not model:IsA("Model") then return false end
	
	local hrp = model:FindFirstChild("HumanoidRootPart")
	if not hrp then return false end
	
	-- Check for ManeMesh in any child
	for _, child in pairs(model:GetDescendants()) do
		if child.Name == "ManeMesh" or (child:IsA("SpecialMesh") and child.Name:lower():find("mane")) then
			return true, hrp
		end
	end
	
	return false
end

-- Function to get closest valid target
local function getClosestHorse()
	local character = player.Character
	if not character then return nil end
	
	local rootPart = character:FindFirstChild("HumanoidRootPart")
	if not rootPart then return nil end
	
	local closestHorse = nil
	local closestDistance = math.huge
	
	-- Check all models in workspace
	for _, obj in pairs(workspace:GetChildren()) do
		local isValid, targetHRP = isValidTarget(obj)
		
		if isValid and targetHRP then
			local distance = (rootPart.Position - targetHRP.Position).Magnitude
			
			if distance <= AUTO_THROW_RANGE and distance < closestDistance then
				closestHorse = obj
				closestDistance = distance
			end
		end
	end
	
	return closestHorse, closestDistance
end

-- Function to check if lasso is equipped
local function isLassoEquipped()
	local character = player.Character
	if not character then return false end
	
	local tool = character:FindFirstChildOfClass("Tool")
	return tool ~= nil
end

-- Function to throw lasso
local function throwLasso()
	-- Try multiple methods
	local success = false
	
	-- Method 1: mouse1click
	pcall(function()
		mouse1click()
		success = true
	end)
	
	if not success then
		-- Method 2: mouse1press/release
		pcall(function()
			mouse1press()
			task.wait(0.05)
			mouse1release()
			success = true
		end)
	end
	
	if not success then
		-- Method 3: Virtual Input
		pcall(function()
			local vim = game:GetService("VirtualInputManager")
			local camera = workspace.CurrentCamera
			local viewportSize = camera.ViewportSize
			vim:SendMouseButtonEvent(viewportSize.X/2, viewportSize.Y/2, 0, true, game, 0)
			task.wait(0.05)
			vim:SendMouseButtonEvent(viewportSize.X/2, viewportSize.Y/2, 0, false, game, 0)
			success = true
		end)
	end
	
	return success
end

-- Main loop
local function autoThrowLoop()
	print("ðŸŽ¯ Auto Lasso Throw started!")
	print("ðŸ“ Range: " .. AUTO_THROW_RANGE .. " studs")
	print("â±ï¸ Cooldown: " .. THROW_COOLDOWN .. " seconds")
	print("=====================================")
	
	while running do
		task.wait(CHECK_INTERVAL)
		
		local currentTime = tick()
		
		-- Check cooldown
		if currentTime - lastThrowTime < THROW_COOLDOWN then
			continue
		end
		
		-- Check if lasso is equipped
		if not isLassoEquipped() then
			continue
		end
		
		-- Get closest target
		local target, distance = getClosestHorse()
		
		if target then
			print("ðŸ´ Found target: " .. target.Name .. " at " .. math.floor(distance) .. " studs")
			
			-- Throw lasso
			if throwLasso() then
				lastThrowTime = currentTime
				print("âœ… Lasso thrown!")
			else
				print("âŒ Failed to throw lasso")
			end
		end
	end
end

-- Start
task.spawn(autoThrowLoop)

-- Stop function
getgenv().StopAutoLasso = function()
	running = false
	print("ðŸ›‘ Auto Lasso Throw stopped!")
end

print("âœ… AUTO LASSO SCRIPT LOADED")
print("ðŸ’¡ Type 'StopAutoLasso()' in console to stop")
