-- Auto Lasso Throw Script
-- pls update

local Players = game:GetService("Players")
local CollectionService = game:GetService("CollectionService")
local VirtualInputManager = game:GetService("VirtualInputManager")

local player = Players.LocalPlayer
local mouse = player:GetMouse()

-- Configuration
local CHECK_INTERVAL = 0.2 -- How often to check for horses (in seconds)
local AUTO_THROW_RANGE = 5 -- Range to auto-throw
local THROW_COOLDOWN = 1.5 -- Cooldown between throws

-- State
local lastThrowTime = 0
local running = true

-- Function to get closest horse in range
local function getClosestHorse()
	local character = player.Character
	if not character then return nil end
	
	local rootPart = character:FindFirstChild("HumanoidRootPart")
	if not rootPart then return nil end
	
	local closestHorse = nil
	local closestDistance = math.huge
	
	for _, animal in pairs(CollectionService:GetTagged("LassoCapture")) do
		if animal:IsDescendantOf(workspace) then
			local success, result = pcall(function()
				return animal:GetBoundingBox()
			end)
			
			if success and result then
				local distance = (rootPart.Position - result.Position).Magnitude
				
				if distance <= AUTO_THROW_RANGE and distance < closestDistance then
					closestHorse = animal
					closestDistance = distance
				end
			end
		end
	end
	
	return closestHorse, closestDistance
end

-- Function to check if lasso is equipped
local function isLassoEquipped()
	local character = player.Character
	if not character then return false end
	
	local tool = character:FindFirstChildOfClass("Tool")
	if tool and (tool.Name:lower():find("lasso") or tool:FindFirstChild("Handle")) then
		return true
	end
	
	return false
end

-- Function to simulate input (works on both PC and Mobile)
local function simulateClick()
	local viewportSize = workspace.CurrentCamera.ViewportSize
	local centerX = viewportSize.X / 2
	local centerY = viewportSize.Y / 2
	
	-- Check if we're on mobile or PC
	local UserInputService = game:GetService("UserInputService")
	
	if UserInputService.TouchEnabled and not UserInputService.MouseEnabled then
		-- Mobile: Simulate touch
		pcall(function()
			VirtualInputManager:SendTouchEvent(0, centerX, centerY)
			task.wait(0.05)
			VirtualInputManager:SendTouchEvent(1, centerX, centerY)
		end)
	else
		-- PC: Simulate mouse click
		pcall(function()
			mouse1press()
			task.wait(0.05)
			mouse1release()
		end)
	end
end

-- Main auto-throw loop
local function autoThrowLoop()
	print("Auto Lasso Throw started!")
	
	while running do
		task.wait(CHECK_INTERVAL)
		
		local currentTime = tick()
		
		-- Check cooldown
		if currentTime - lastThrowTime < THROW_COOLDOWN then
			continue
		end
		
		-- Check if lasso is equipped
		if not isLassoEquipped() then
			continue
		end
		
		-- Get closest horse
		local horse, distance = getClosestHorse()
		
		if horse then
			print("Found horse:", horse.Name, "at distance:", math.floor(distance))
			
			-- Simulate click/tap to throw lasso
			simulateClick()
			
			lastThrowTime = currentTime
			
			print("Threw lasso!")
		end
	end
end

-- Start the loop
task.spawn(autoThrowLoop)

print("=================================")
print("AUTO LASSO THROW LOADED")
print("Platform:", game:GetService("UserInputService").TouchEnabled and "MOBILE" or "PC")
print("Range:", AUTO_THROW_RANGE, "studs")
print("=================================")

-- Optional: Stop the script
getgenv().StopAutoLasso = function()
	running = false
	print("Auto Lasso Throw stopped!")
end
