-- AUTO-SELL ALL *UNLOCKED* HORSES

local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Players = game:GetService("Players")
local player = Players.LocalPlayer

local References = require(ReplicatedStorage:WaitForChild("References"))
local Items = References.Items
local InventoryHandler = require(References.PlayerScripts.Priority:WaitForChild("InventoryHandler"))
local Utilities = References.Utilities

local horseGuids = {}
local lockedTable = InventoryHandler.local.locked or {}

for name, item in pairs(Items.byName) do
    -- Only items whose species is Horse
    local info = Items.byId[item.id]
    if info and info.species == "Horse" then

        -- Get all GUIDs of this specific horse type
        local guids = InventoryHandler.GetGuidsOfItemId(item.id)
        for _, guid in ipairs(guids) do

            -- Ignore locked horses
            if not lockedTable[guid] then
                table.insert(horseGuids, guid)
            end
        end
    end
end

if #horseGuids == 0 then
    warn("No unlocked horses to sell.")
    return
end

-- Sell them via Larry's official shop event
Utilities.Network:FireServer("Shopping", "SellItems", horseGuids)

print("Requested sale of", #horseGuids, "unlocked horses.")
